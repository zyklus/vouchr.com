SELECT CONCAT('UPDATE product p', CASE WHEN a.en IS NULL THEN '' ELSE CONCAT(' INNER JOIN localized_strings a ON p.fk_name_string_id=a.pk_id AND a.en=\'', a.en, '\'') END, CASE WHEN b.en IS NULL THEN '' ELSE CONCAT(' INNER JOIN localized_strings b ON p.fk_manufacturer_string_id=b.pk_id AND b.en=\'', b.en, '\'') END, CASE WHEN c.en IS NULL THEN '' ELSE CONCAT(' INNER JOIN localized_strings c ON p.fk_family_string_id=c.pk_id AND c.en=\'', c.en, '\'') END, ' SET p.img=\'', p.img, '\'', CASE WHEN a.en IS NULL THEN ' WHERE p.fk_name_string_id IS NULL' ELSE '' END, ';') query FROM product p LEFT JOIN localized_strings a ON p.fk_name_string_id=a.pk_id LEFT JOIN localized_strings b ON p.fk_manufacturer_string_id=b.pk_id LEFT JOIN localized_strings c ON p.fk_family_string_id=c.pk_id WHERE p.img!='';